# 北京大学某单位的某台机器

其IP地址为162.105.80.160, 子网掩码为255.255.255.192，则：

- 该单位的网络号为：162.105.80.128
- 该单位理论上能容纳的主机数：64
- 北大类似的子网数：1024

# TCP协议

## TCP连接建立的三次握手

所谓三次握手（**Three-Way Handshake**）即建立TCP连接，就是指建立一个TCP连接时，需要客户端和服务端总共发送3个包以确认连接的建立。在socket编程中，这一过程由客户端执行connect来触发，整个流程如下图所示：

![三次握手](https://github.com/zivpei/ichw/blob/master/2964446-aa923712d5218eeb.png)

1. 第一次握手：Client将标志位 **SYN**置为1，随机产生一个值 **seq**=J，并将该数据包发送给Server，Client进入 **SYN_SENT**状态，等待Server确认。

2. 第二次握手：Server收到数据包后由标志位 **SYN**=1知道Client请求建立连接，Server将标志位 **SYN**和 **ACK**都置为1，**ack**=J+1，随机产生一个值 **seq**=K，并将该数据包发送给Client以确认连接请求，Server进入 **SYN_RCVD**状态。

3. 第三次握手：Client收到确认后，检查 **ack**是否为J+1，**ACK**是否为1，如果正确则将标志位 **ACK**置为1，**ack**=K+1，并将该数据包发送给Server，Server检查 **ack**是否为K+1，**ACK**是否为1，如果正确则连接建立成功，Client和Server进入ESTABLISHED状态，完成三次握手，随后Client与Server之间可以开始传输数据了。

## 三次握手的必要性

1. 考虑一次握手，首先TCP是面向连接，一次握手肯定建立不了连接，因为客户机给服务器发出请求信息却没有得到回应，客户机是没法判定是否发送成功然后建立连接的。

2. 再看两次，假设只有两次握手，比如图中的1，2步，当A想要建立连接时发送一个 **SYN**，然后等待 **ACK**，结果这个 **SYN**因为网络问题没有及时到达B，所以A在一段时间内没收到 **ACK**后，再发送一个 **SYN**，这次B顺利收到，接着A也收到 **ACK**，这时A发送的第一个 **SYN**终于到了B，对于B来说这是一个新连接请求，然后B又为这个连接申请资源，返回 **ACK**，然而这个 **SYN**是个无效的请求，A收到这个 **SYN**的 **ACK**后也并不会理会它，而B却不知道，B会一直为这个连接维持着资源，造成资源的浪费。

3. 两次握手的问题在于服务器端不知道一个 **SYN**是否是无效的，而三次握手机制因为客户端会给服务器回复第二次握手，也意味着服务器会等待客户端的第三次握手，如果第三次握手迟迟不来，服务器便会认为这个 **SYN**是无效的，释放相关资源。但这时有个问题就是客户端完成第二次握手便认为连接已建立，而第三次握手可能在传输中丢失，服务端会认为连接是无效的，这时如果Client端向Server写数据，Server端将以RST包响应，这时便感知到Server的错误。

    总之，三次握手可以保证任何一次握手的失败都是可感知的，不会浪费资源

# 恶意软件

## 基本定义

"恶意软件"用作一个集合名词，来指代故意在计算机系统
上执行恶意任务的病毒、蠕虫和特洛伊木马。

网络用户在浏览一些恶意网站，或者从不安全的站点下载游戏或其它程序时，往往会连合恶意程序一并带入自己的电脑，而用户本人对此丝毫不知情。直到有恶意广告不断弹出或色情网站自动出现时，用户才有可能发觉电脑已“中毒”。在恶意软件未被发现的这段时间，用户网上的所有敏感资料都有可能被盗走，比如银行帐户信息，信用卡密码等。

这些让受害者的电脑不断弹出色情网站或者是恶意广告的程序就叫做恶意软件，它们也叫做流氓软件。

## 恶意软件种类

- 特洛伊：
    该程序看上去有用或无害，但却包含了旨在利用或损坏运
    行该程序的系统的隐藏代码。特洛伊木马程序通常通过没有正确说明此程序的用途和功能的电子邮件传递给用户。它也称为特洛伊代码。特洛伊木马通过在其运行时传递恶意负载或任务达到此目的。

- 蠕虫：
    蠕虫使用自行传播的恶意代码，它可以通过网络连接自动将其自身
    从一台计算机分发到另一台计算机上。蠕虫会执行有害操作，例如，消耗网络或本地系统资源，这样可能会导致拒绝服务攻击。某些蠕虫无须用户干预即可执行和传播，而其他蠕虫则需用户直接执行蠕虫代码才能传播。除了复制，蠕虫也可能传递负载。

- 病毒：
    病毒代码的明确意图就是自行复制。病毒尝试将其自身附加到宿主程序，以便在计算机之间进行传播。它可能会损害硬件、软件或数据。宿主程序执行时，病毒代码也随之运行，并会感染新的宿主，有时还会传递额外负载。

## 防范措施

因为恶意软件由多种威胁组成，所以需要采取多处方法和技术来保卫系统。如采用防火墙来过滤潜在的破坏性代码，采用垃圾邮件过滤器、入侵检测系统、入侵防御系统等来加固网络，加强对破坏性代码的防御能力。

作为一种最强大的反恶意软件防御工具，反病毒程序可以保护计算机免受病毒、蠕虫、特洛伊木马的威胁。近几年来，反病毒软件的开发商已经逐渐将垃圾邮件和间谍软件等威胁的防御功能集成到其产品中。

除了这些技术手段之外，企业应当采取措施防止恶意软件在单位网络内传播。
